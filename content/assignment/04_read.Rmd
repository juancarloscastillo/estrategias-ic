---
title: "Working with the CQ Data"
date: "2019-01-31"
editor_options: 
  chunk_output_type: console
---

# Working with the CQ Data

```{r setup, include=TRUE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(janitor)
library(lubridate)
library(socviz)

```

```{r local-functions}

## Calculate age in years, months, or days
calc_age <- function(birth_date, ref_date = Sys.Date(), unit = "year") {

    require(lubridate)

    period <- as.period(interval(birth_date, ref_date),
                        unit = unit)

    switch(unit,
           year = year(period),
           month = month(period),
           day = day(period),
           stop = "Unknown time unit. Choose year, month, or day.")

}

```

## Load it

```{r load}

filenames <- dir(path = "data/clean",
                 pattern = "*.csv",
                 full.names = TRUE)

filenames

data <- filenames %>% map_dfr(read_csv, .id = "congress")

data <- clean_names(data)

```

## Recodes




```{r jwervin}

data$born[data$last == "Ervin" & data$first == "Joseph"] <- ymd("1901-03-01")

```

Join sessions to main data.

William Joseph Green Jr and William Joseph Green III are father
and son; the latter succeeded to his father's seat. The raw data
have a mistaken entry for the son in the 79th (1945) congress,
giving his `start_age` as 6.


## New Variables

- `poc`: Person of color; binary
- `days_old`: N days old
- `months_old`: N months old
- `full_name`: Full Name
- `end_career`: Date of end career
- `entry_age`:  Age when first entered congress
- `yr_fac`: start_year as a factor rather than a date

